#! /bin/hilbish
-- ss: minimal screenshot script for sharex hosts
-- check ssf for more details

function runcmd(cmd, giveout)
	local cmd = cmd:gsub("\\x(%x%x)",function (x) return string.char(tonumber(x,16)) end)
	if giveout then
		local f = io.popen(cmd)
		local output = f:read '*all'
		local out = output:gsub('\n', '')
		f:close()

		return out
	else
		return os.execute(cmd)
	end
end

local errcode = runcmd 'maim -u -o -s /tmp/screenshot.png'
if errcode == 1 then
	os.exit(1)
end

runcmd 'notify-send -t 2000 "Screenshot taken, uploading..."'
runcmd 'ssf /tmp/screenshot.png'
